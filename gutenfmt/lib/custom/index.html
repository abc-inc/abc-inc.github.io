<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>gutenfmt/gutenfmt/lib/custom/</title><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="all,follow"><meta name=googlebot content="index,follow,snippet,archive"><link rel=stylesheet href=http://fonts.cdnfonts.com/css/cascadia-code><link rel=stylesheet href=https://abc-inc.github.io/gutenfmt/hugo-theme-console/css/terminal-0.7.1.min.css><link rel=stylesheet href=https://abc-inc.github.io/gutenfmt/hugo-theme-console/css/animate-3.7.2.min.css><link rel=stylesheet href=https://abc-inc.github.io/gutenfmt/hugo-theme-console/css/console.css><!--[if lt IE 9]><script src=https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js></script><script src=https://oss.maxcdn.com/respond/1.4.2/respond.min.js></script><![endif]--><meta property="og:title" content="Customization"><meta property="og:description" content><meta property="og:type" content="article"><meta property="og:url" content="https://abc-inc.github.io/gutenfmt/lib/custom/"><meta name=twitter:title content="Customization"><meta name=twitter:description content="Formatting maps The order is not specified and is not guaranteed to be the same from one invocation to the next. If a certain order is required, you must define a custom Formatter and specify the order:
m := map[string]interface{}{&#34;a&#34;: &#34;A&#34;, &#34;b&#34;: &#34;B&#34;, &#34;c&#34;: &#34;C&#34;} w := NewTab(os.Stdout) // Create a custom formatter, which outputs certain map entries in the given order. ks := []reflect.Value{reflect.ValueOf(&#34;c&#34;), reflect.ValueOf(&#34;a&#34;)} f := formatter.FromMapKeys(&#34;\t&#34;, &#34;\t\n&#34;, ks."><style type=text/css>pre code{overflow-x:auto}.posts-list!>p{left:-130px;position:relative}a.active{background-color:var(--primary-color);color:var(--invert-font-color)}.strong{display:inline-block;font-weight:700;margin-top:1em}@media only screen and (min-width:851px){.container{padding-left:200px}.menu.posts-list{left:-110px!important;padding-left:130px;position:fixed;top:75px}}@media only screen and (max-width:850px){.menu.posts-list{position:relative!important}.posts-list .date{display:inherit;position:inherit}}</style></head><body class=terminal><div class=container><div class=terminal-nav><header class=terminal-logo><div class="logo terminal-prompt"><a href=https://abc-inc.github.io/gutenfmt/ class=no-style>gutenfmt</a> / <a href=https://abc-inc.github.io/gutenfmt/lib>lib</a> / <a href=https://abc-inc.github.io/gutenfmt/lib/custom>custom</a></div></header><nav class=terminal-menu><ul vocab="https://schema.org/" typeof="BreadcrumbList"><li><a href=https://github.com/abc-inc/gutenfmt/ target=_blank typeof="ListItem"><img src=https://github.com/fluidicon.png alt height=24 style=width:auto title="project on GitHub"></a></li><li><a href=https://pkg.go.dev/github.com/abc-inc/gutenfmt/ target=_blank typeof="ListItem"><img src=https://pkg.go.dev/static/shared/icon/favicon.ico alt height=24 style=width:auto title="discover on pkg.go.dev"></a></li></ul></nav></div></div><div class=container><div class="menu posts-list"><div class=post><div><a href=https://abc-inc.github.io/gutenfmt/intro/ class=strong title=Introduction>Introduction</a></div></div><div class=post><div>&nbsp;&nbsp;<a href=https://abc-inc.github.io/gutenfmt/intro/similar/ title="Similar Projects">Similar Projects</a></div></div><div class=post><div><a href=https://abc-inc.github.io/gutenfmt/cmd/ class=strong title=Manual>Manual</a></div></div><div class=post><div>&nbsp;&nbsp;<a href=https://abc-inc.github.io/gutenfmt/cmd/output/ title="Output Formats">Output Formats</a></div></div><div class=post><div>&nbsp;&nbsp;&nbsp;&nbsp;<a href=https://abc-inc.github.io/gutenfmt/cmd/output/json/ title=json>json</a></div></div><div class=post><div>&nbsp;&nbsp;&nbsp;&nbsp;<a href=https://abc-inc.github.io/gutenfmt/cmd/output/jsonc/ title=jsonc>jsonc</a></div></div><div class=post><div>&nbsp;&nbsp;&nbsp;&nbsp;<a href=https://abc-inc.github.io/gutenfmt/cmd/output/table/ title=table>table</a></div></div><div class=post><div>&nbsp;&nbsp;&nbsp;&nbsp;<a href=https://abc-inc.github.io/gutenfmt/cmd/output/text/ title=text>text</a></div></div><div class=post><div>&nbsp;&nbsp;&nbsp;&nbsp;<a href=https://abc-inc.github.io/gutenfmt/cmd/output/tsv/ title=tsv>tsv</a></div></div><div class=post><div>&nbsp;&nbsp;&nbsp;&nbsp;<a href=https://abc-inc.github.io/gutenfmt/cmd/output/yaml/ title=yaml>yaml</a></div></div><div class=post><div>&nbsp;&nbsp;&nbsp;&nbsp;<a href=https://abc-inc.github.io/gutenfmt/cmd/output/yamlc/ title=yamlc>yamlc</a></div></div><div class=post><div><a href=https://abc-inc.github.io/gutenfmt/lib/ class=strong title="Go Library">Go Library</a></div></div><div class=post><div>&nbsp;&nbsp;<a href=https://abc-inc.github.io/gutenfmt/lib/getting-started/ title="Getting Started">Getting Started</a></div></div><div class=post><div>&nbsp;&nbsp;<a href=https://abc-inc.github.io/gutenfmt/lib/custom/ class=active title=Customization>Customization</a></div></div><div class=post><div>&nbsp;&nbsp;<a href=https://abc-inc.github.io/gutenfmt/lib/examples/ title=Examples>Examples</a></div></div></div></div><div class=container style=margin-left:auto><aside><header><h1>Table of Contents</h1></header><nav id=TableOfContents><ul><li><a href=#maps>Formatting maps</a></li><li><a href=#resolver>Use different metadata for a struct</a></li><li><a href=#jsoniter>Use jsoniter instead of encoding/json</a></li></ul></nav></aside><h1>Customization</h1><h2 id=maps>Formatting maps</h2><p>The order is not specified and is not guaranteed to be the same from one invocation to the next.
If a certain order is required, you must define a custom <strong>Formatter</strong> and specify the order:</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-go data-lang=go>m <span style=color:#000;font-weight:700>:=</span> <span style=color:#000;font-weight:700>map</span>[<span style=color:#458;font-weight:700>string</span>]<span style=color:#000;font-weight:700>interface</span>{}{<span style=color:#d14>&#34;a&#34;</span>: <span style=color:#d14>&#34;A&#34;</span>, <span style=color:#d14>&#34;b&#34;</span>: <span style=color:#d14>&#34;B&#34;</span>, <span style=color:#d14>&#34;c&#34;</span>: <span style=color:#d14>&#34;C&#34;</span>}
w <span style=color:#000;font-weight:700>:=</span> <span style=color:#900;font-weight:700>NewTab</span>(os.Stdout)

<span style=color:#998;font-style:italic>// Create a custom formatter, which outputs certain map entries in the given order.
</span><span style=color:#998;font-style:italic></span>ks <span style=color:#000;font-weight:700>:=</span> []reflect.Value{reflect.<span style=color:#900;font-weight:700>ValueOf</span>(<span style=color:#d14>&#34;c&#34;</span>), reflect.<span style=color:#900;font-weight:700>ValueOf</span>(<span style=color:#d14>&#34;a&#34;</span>)}
f <span style=color:#000;font-weight:700>:=</span> formatter.<span style=color:#900;font-weight:700>FromMapKeys</span>(<span style=color:#d14>&#34;\t&#34;</span>, <span style=color:#d14>&#34;\t\n&#34;</span>, ks<span style=color:#000;font-weight:700>...</span>)
<span style=color:#998;font-style:italic>// Register the formatter for type map[string]interface{}.
</span><span style=color:#998;font-style:italic></span>w.Formatter.<span style=color:#900;font-weight:700>SetFormatter</span>(reflect.<span style=color:#900;font-weight:700>TypeOf</span>(m).<span style=color:#900;font-weight:700>String</span>(), f)

n, err <span style=color:#000;font-weight:700>:=</span> w.<span style=color:#900;font-weight:700>Write</span>(m)
<span style=color:#998;font-style:italic>// Output:
</span><span style=color:#998;font-style:italic>// c	C
</span><span style=color:#998;font-style:italic>// a	A
</span></code></pre></div><p>Similarly, a custom <strong>Formatter</strong> can be used for <strong>map</strong> slice:</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-go data-lang=go>ms <span style=color:#000;font-weight:700>:=</span> []<span style=color:#000;font-weight:700>map</span>[<span style=color:#458;font-weight:700>string</span>]<span style=color:#000;font-weight:700>interface</span>{}{m}

<span style=color:#998;font-style:italic>// Create another formatter - using FromMapSliceKeys().
</span><span style=color:#998;font-style:italic>// The keys could be the same as before, or different if another output format is needed.
</span><span style=color:#998;font-style:italic></span>f <span style=color:#000;font-weight:700>:=</span> formatter.<span style=color:#900;font-weight:700>FromMapSliceKeys</span>(<span style=color:#d14>&#34;\t&#34;</span>, <span style=color:#d14>&#34;\t\n&#34;</span>, ks<span style=color:#000;font-weight:700>...</span>)
w.Formatter.<span style=color:#900;font-weight:700>SetFormatter</span>(reflect.<span style=color:#900;font-weight:700>TypeOf</span>(ms).<span style=color:#900;font-weight:700>String</span>(), f)

n, err <span style=color:#000;font-weight:700>:=</span> w.<span style=color:#900;font-weight:700>Write</span>(ms)
<span style=color:#998;font-style:italic>// Output:
</span><span style=color:#998;font-style:italic>// c	a
</span><span style=color:#998;font-style:italic>// C	A
</span></code></pre></div><h2 id=resolver>Use different metadata for a struct</h2><p>By default, a reflection-based <strong>Resolver</strong> extracts field information of <strong>struct</strong> types.
It looks for the <strong>json</strong> tag and returns its name, if present, or the field name instead.
The community welcomed tags and has built ORMs, further encodings, flag parsers and much more
around them since, especially for these tasks, single-sourcing is beneficial for data structures.</p><p>The default <strong>Resolver</strong> can be changed so that it looks for another tag such as <strong>yaml</strong> instead.
This can be done by setting a new <strong>Resolver</strong>.</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-go data-lang=go>meta.Resolve = TagResolver{<span style=color:#d14>&#34;yaml&#34;</span>}.lookup
</code></pre></div><p>Several well-known frameworks and their <strong>struct</strong> tags are listed at:
<a href=https://github.com/golang/go/wiki/Well-known-struct-tags>https://github.com/golang/go/wiki/Well-known-struct-tags</a></p><h2 id=jsoniter>Use jsoniter instead of encoding/json</h2><p><em>jsoniter</em> (json-iterator) is a fast and flexible JSON parser available in Java and <a href=https://github.com/json-iterator/go>Go</a>.
It can be used as a drop-in replacement for &ldquo;<strong>encoding/json</strong>&rdquo;.</p><p>In order to build another project, having <em>gutenfmt</em> using jsoniter, use the <strong>jsoniter</strong> build tag as follows:</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell>go build -tags<span style=color:#000;font-weight:700>=</span>jsoniter ./...
</code></pre></div><p>For building <em>gutenfmt</em> as a standalone binary, it is recommended to use it&rsquo;s <strong>Makefile</strong> and set <strong>GOFLAGS</strong> accordingly:</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=color:teal>GOFLAGS</span><span style=color:#000;font-weight:700>=</span><span style=color:#d14>&#39;-tags=jsoniter&#39;</span> make
</code></pre></div><div class=footer>Powered by <a href=https://gohugo.io/>Hugo</a> with
<a href=https://github.com/mrmierzejewski/hugo-theme-console/>Console Theme</a>.</div></div></body></html>